---
title: "바퀴 부착 위치를 추정하여 주행 안정성을 확보하는 알고리즘"
description: "Team_CIE-ONE"
year: "2025"
technologies: ["React", "Raspberry Pi", "MQTT"]
members: ["김대현", "김현민","송유정","허예진"]
imageUrl: "/onemain.jpg"
---

## 개요
현존하는 휠-기반의 이동형 로봇은 설계 및 제작 단계에서부터 정해진 몸체 또는 플랫폼에 정해진 위치에 바퀴가 부착된다. 이 작품은 기존의 수동 주행체(카트 등) 또는 주행 불가능한 사물(상자, 팔레트 등)에 별도의 위치 제약 없이 부착할 수 있는 스마트 바퀴 모듈을 개발하는 것을 목표로 한다.

이를 위해 각 바퀴가 특정 사물의 하부에 부착되는 위치를 추정하는 AI 기반 알고리즘을 설계함으로써 수동 주행체 또는 일반 사물을 전동화·자동화·자율주행화 등으로 발전시킬 수 있는 이동형 로봇의 새로운 형태를 제안하는 작품이다.

## 하드웨어 시스템 구성
각 바퀴 모듈은 동일한 형태의 하우징을 갖도록 제작되며, 각각 좌측 앞바퀴, 우측 앞바퀴, 좌측 뒷바퀴, 우측 뒷바퀴 역할을 수행하도록 대상체에 모듈이 부착되는 위치에 따라 2조 DIP 스위치를 통해 ID를 부여하여 제어된다. 모든 모듈은 동등한 지위(슬레이브)를 가지며, 상위 제어를 담당할 프로세서와 데이터 통신을 하도록 상위 제어기(마스터)가 포함된다.
- **제어부**: ESP32 – Jetson Nano (or PC)

각 모듈에 탑재된 LOLIN D32 Pro 보드는 상위 제어기 역할을 수행하는 Jetson Nano Developer Kit 보드 (Yahboom)로부터 제어 지령을 하달받도록 설계하고자 하였으나, 보유중인 Jetson Nano 보드를 Flash하고 Boot 이미지를 굽는데에 난항을 겪어 본 I.E.경진대회에서는 PC와 직접 Bluetooth BPP 통신을 하여 시연하도록 개발 방향을 우회하였다. 상위 제어기는 각 슬레이브 보드로부터 수신한 거리 및 엔코더 정보들로 연산을 수행하여 제어 지령을 전달하고, 다시 슬레이브 보드는 지령에 적합한 PWM 신호를 생성하여 모터를 구동한다.

- **센서부**: HC-SR04

각 모듈에는 주변 지형지물과의 거리를 측정하기 위한 거리 센서들이 탑재된다. 본 프로토타입은 장애물 회피 등의 자율주행 기능을 배제하고 설계되어 LiDAR를 탑재하지 않고 단순히 전방 장애물과의 거리 측정 정보만을 이용하는 방식을 채택하였다. 동일한 하우징을 갖기 위해 초음파센서 HC-SR04를 앞, 뒤로 2개씩 부착하였다. setup() 영역에서 DIP 스위치를 통한 ID 부여가 이뤄진 후, 모듈의 부착 위치에 적합한 초음파센서의 Trig와 Echo핀에 pinMode를 설정하는 방식으로 활성화시킨다.

- **전원부**: 18650 3S2P Pack(12V, 5200mAh)

각 모듈에 탑재되는 LOLIN D32 Pro 보드와 모터 드라이브에 전력을 공급하기 위해 18650 DC 배터리셀 6구를 3S2P 직병렬 구조로 연결한 배터리 팩을 전력원으로 사용한다. 5200mAh 용량의 DC 12V 출력을 지원하여 DC 모터 구동을 위한 +12V 전압을 L298N 모터드라이버에 직접 공급할 수 있다. LOLIN D32 Pro 보드에 외부 전압원을 연결하는 방법으로 VBUS 핀을 외부로 노출시킨 “USB” 핀에 +5V를 공급할 수 있다. 서보모터 MG 996R을 구동하기 위해서도 +5V 전원을 필요로 하므로, 12V 전압을 5V로 Step-down 하는 DC-DC 강하형 컨버터를 사용하여 +5V 전압을 공급한다. 초음파센서 HC-SR04는 Vcc로 3.3V 또는 5V 전압을 공급받아 동작하므로, LOLIN D32 Pro 보드의 +3.3V 전압 출력을 연결하여 공급한다. Trig 신호는 3.3V 논리 레벨로도 작동하나 Echo 신호는 HC-SR04 내부 회로에 의해 5V로 승압되어 출력되므로, LOLIN D32 Pro 보드에서 해당 신호를 받기 위해 1kΩ:2kΩ 전압 분배를 통해 3.3V로 낮추어 연결한다.

- **구동부**: MG996R + CHR-3162(12V, 4000RPM)

바퀴의 조향축을 담당하는 조향 모터로 MG 996R 서보모터를 탑재한다. 120° 조향이 가능하며, setup() 영역에서 모듈 별 조립 상태에 따라 초기 각 위치를 달리 하도록 프로그래밍하였다. 바퀴의 구동축을 담당하는 구동 모터로 CHR-3162 12V 4000RPM DC모터를 탑재한다. 해당 모터는 엔코더를 포함하여 회전수를 측정할 수 있으며, 모듈의 부착 위치에 따라 정회전(전진) 방향을 시계 또는 반시계 방향으로 지정하여 제어하도록 프로그래밍하였다.

- **통신부**: Bluetooth 5.0 BPP

각 모듈의 LOLIN D32 Pro 보드는 초음파센서로 감지한 거리 데이터를 상위 제어기로 송신하고, 현 상태에 적합한 모터 제어 지령값을 수신한다. 각 모듈은 서로 이격되어 부착되므로, 위와 같은 데이터 교환을 무선 통신으로 수행해야 한다. 본 프로토타입에서는 상위 제어기와 1:4 통신을 구현하기 위해 Bluetooth BPP 방식을 채택하였다. LOLIN D32 Pro 보드는 WiFi 통신도 지원하며, UWB 통신 모듈(ex. DWM1000)을 추가로 탑재할 수도 있으므로, 향후 자율 주행 기능을 포함하여 더 넓은 범위의 동작을 수행할 수 있도록 변경이 가능하다.

## 소프트웨어 시스템 구성
- **부착 위치 특정 알고리즘**

이 알고리즘은 직육면체 모양의 물체를 주행체로 전환하는 상황을 가정하여 설계하였다. 사용자가 하부에 바퀴 모듈 4개를 임의로 부착하면, 바퀴 축이 하나로 연결되지 않아 완벽히 일직선으로 정렬되기 어렵다. 바퀴 부착 위치를 특정하기 위한 제자리 조향 등의 초기 동작을 수행하면서 정면의 지형지물과 거리를 측정한다. (단, 정면의 지형지물은 주행체 전면과 평행한 벽면을 가정하였다.) 주행체의 전면으로부터 얼마나 떨어진 위치에 부착되었는지에 따라 초기위치, 상대위치로부터의 거리 벡터 성분이 달라지므로, Matlab/Simulink를 통해 키네마틱 모델을 제작하고 Matlab 스크립트를 통해 데이터셋을 수집한다. 이후 PyTorch Geometric을 통해 그래프 신경망(Graph Neural Network, GNN) 모델 프레임을 작성하고 초기 학습을 수행하여 알고리즘을 정형화한다.

- **개발 환경**

LOLIN D32 Pro 보드에 탑재할 프로그램을 작성하기 위해 C++ 언어 기반의 Arduino 명령어 및 함수들을 사용함으로써 보다 직관적으로 쉽게 이해하면서 코딩할 수 있도록 하였다. 이를 위해 VS Code에 PlatformIO 확장을 적용하여 Arduino IDE 환경을 구성하였다. 키네마틱 모델 제작과 데이터 수집을 위해 Matlab/Simulink 툴을 사용하고, GNN 모델 초기 학습을 위해 PyTorch 툴을 사용한다.

## 적용 대상 및 향후 개발 계획
물류 산업이 점차 자동화 되면서 화물 피킹과 이송 등의 작업을 사람 대신 AGV(Automated Guided Vehicle)와 AMR (Autonomous Mobile Robot)이 대체하고 있다. 이 중, 가이드 준수 방식으로 이동하는 AGV는 비교적 기술 수준이 낮아 해당 작품을 업그레이드할 목표로 삼기에 적합하다고 보인다. 만약 단일 플랫폼으로 정형화된 AGV 형태의 운반 로봇 한 대 가격보다 본 바퀴 모듈 4개 가격이 더 저렴하다면 경쟁력이 있을 것으로 보인다.

앞으로 본 개발품의 정상 작동을 위해서 전원부 회로에 과전압 및 과전류 보호 회로를 포함하여 블루투스 기능을 구현해내고, 알고리즘 및 딥러닝 모델 제작을 최종 목표로 삼는다.